{% extends 'base.html.twig' %}

{% block title %}Admin - Contrats{% endblock %}

{% block body %}
<div class="page-header">
    <h1>Gestion des Contrats</h1>
    <a href="{{ path('admin_contrats_new') }}" class="btn btn-primary">+ Nouveau Contrat</a>
</div>

<table>
    <thead>
        <tr><th>ID</th><th>Type</th><th>Bien</th><th>Statut</th><th>Cosignataires</th><th>Date</th><th>Actions</th></tr>
    </thead>
    <tbody>
        {% for c in contrats %}
        <tr>
            <td>{{ c.id }}</td>
            <td><span class="badge {{ c.type == 'ACHAT' ? 'badge-sale' : 'badge-rent' }}">{{ c.type }}</span></td>
            <td>{% if c.bien %}{{ c.bien.type ?? '' }} - {{ c.bien.rue ?? '' }}, {{ c.bien.ville ?? '' }}{% else %}-{% endif %}</td>
            <td><span class="badge badge-{{ c.statut|lower }}">{{ c.statut }}</span></td>
            <td>
                {% if c.cosigners %}
                    {% for cs in c.cosigners %}{{ cs.prenom }} {{ cs.nom }} ({{ cs.typeSignataire }}){% if not loop.last %}, {% endif %}{% endfor %}
                {% endif %}
            </td>
            <td>{{ c.dateCreation|slice(0, 10) }}</td>
            <td><a href="{{ path('admin_contrats_detail', {id: c.id}) }}" class="btn btn-primary btn-sm">Detail</a></td>
        </tr>
        {% else %}
        <tr><td colspan="7">Aucun contrat.</td></tr>
        {% endfor %}
    </tbody>
</table>

{% if totalPages > 1 %}
<div class="pagination">
    {% for i in 0..totalPages-1 %}
        {% if i == currentPage %}
            <span class="current">{{ i + 1 }}</span>
        {% else %}
            <a href="{{ path('admin_contrats', {page: i}) }}">{{ i + 1 }}</a>
        {% endif %}
    {% endfor %}
</div>
{% endif %}
{% endblock %}
