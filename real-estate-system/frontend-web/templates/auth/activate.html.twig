{% extends 'base.html.twig' %}

{% block title %}Activer mon compte - Horoazhon{% endblock %}

{% block stylesheets %}
<style>
    /* Same background system as login */
    .login-page {
        min-height: calc(100vh - 64px - 60px);
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 2.5rem 1rem;
        position: relative;
        overflow: hidden;
        background: linear-gradient(135deg, #eef2ff 0%, #f0f5ff 50%, #e8eeff 100%);
    }
    .login-page::before {
        content: '';
        position: absolute;
        inset: 0;
        background-image:
            linear-gradient(rgba(37,99,235,0.04) 1px, transparent 1px),
            linear-gradient(90deg, rgba(37,99,235,0.04) 1px, transparent 1px);
        background-size: 40px 40px;
        pointer-events: none;
    }
    .login-deco {
        position: absolute;
        border-radius: 12px;
        pointer-events: none;
    }
    .login-deco-1 {
        width: 200px; height: 200px; top: -40px; right: -20px;
        border: 2px solid rgba(37,99,235,0.08);
        transform: rotate(12deg);
        background: rgba(37,99,235,0.02);
    }
    .login-deco-2 {
        width: 140px; height: 140px; bottom: -30px; left: -20px;
        border: 2px solid rgba(37,99,235,0.06);
        transform: rotate(-15deg);
        background: rgba(37,99,235,0.015);
        border-radius: 16px;
    }
    .login-deco-3 {
        width: 80px; height: 80px; top: 20%; left: 10%;
        border: 1.5px solid rgba(37,99,235,0.05);
        transform: rotate(45deg);
        border-radius: 8px;
    }
    .login-deco-4 {
        width: 60px; height: 60px; bottom: 25%; right: 12%;
        background: rgba(37,99,235,0.04);
        transform: rotate(20deg);
        border-radius: 10px;
    }
    .login-card {
        background: #fff;
        border-radius: 16px;
        border: 1px solid #e2e8f0;
        box-shadow: 0 4px 6px rgba(0,0,0,0.02), 0 12px 40px rgba(0,0,0,0.06);
        padding: 2.5rem;
        width: 100%;
        max-width: 420px;
        position: relative;
        z-index: 1;
    }
    .login-logo { text-align: center; margin-bottom: 1.75rem; }
    .login-logo .logo-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 52px; height: 52px;
        background: linear-gradient(135deg, #3b82f6, #2563eb);
        border-radius: 14px;
        margin-bottom: 0.875rem;
        box-shadow: 0 4px 12px rgba(37,99,235,0.25);
    }
    .login-logo .logo-text { font-size: 1.5rem; font-weight: 800; color: #0f172a; letter-spacing: -0.5px; }
    .login-card h1 { text-align: center; margin-bottom: 0.375rem; color: #0f172a; font-size: 1.35rem; font-weight: 700; letter-spacing: -0.3px; }
    .login-card p { text-align: center; color: #94a3b8; margin-bottom: 2rem; font-size: 0.875rem; }
    .login-card .form-group { margin-bottom: 1.25rem; }
    .login-card .form-group label { font-size: 0.85rem; font-weight: 600; color: #374151; }
    .login-card .form-group input {
        padding: 0.75rem 1rem; border-radius: 10px; font-size: 0.9rem;
        border: 1px solid #e2e8f0;
        transition: border-color 0.2s, box-shadow 0.2s;
    }
    .login-card .form-group input:focus {
        border-color: #2563eb;
        box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
    }
    .login-card .btn-primary, .login-card .btn-secondary {
        width: 100%; padding: 0.8rem; font-size: 0.95rem;
        font-weight: 600; border-radius: 10px; text-align: center;
    }
    .error-message {
        background: #fef2f2; border: 1px solid #fecaca; color: #991b1b;
        padding: 0.75rem 1rem; border-radius: 10px; margin-bottom: 1.25rem;
        font-size: 0.875rem; display: flex; align-items: center; gap: 0.5rem;
    }
    .error-message::before { content: '\2717'; font-weight: bold; flex-shrink: 0; }
    .success-message {
        background: #f0fdf4; border: 1px solid #bbf7d0; color: #166534;
        padding: 0.75rem 1rem; border-radius: 10px; margin-bottom: 1.25rem;
        text-align: center; font-size: 0.875rem;
        display: flex; align-items: center; justify-content: center; gap: 0.5rem;
    }
    .success-message::before { content: '\2713'; font-weight: bold; flex-shrink: 0; }
    .login-footer-text {
        text-align: center; font-size: 0.75rem; color: #94a3b8;
        margin-top: 2rem; position: relative; z-index: 1;
    }
    @media (max-width: 480px) {
        .login-card { padding: 2rem 1.5rem; }
        .login-deco { display: none; }
    }
</style>
{% endblock %}

{% block body %}
<div class="login-page">
    <div class="login-deco login-deco-1"></div>
    <div class="login-deco login-deco-2"></div>
    <div class="login-deco login-deco-3"></div>
    <div class="login-deco login-deco-4"></div>

    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 420px; position: relative; z-index: 1;">
        <div class="login-card">
            <div class="login-logo">
                <div class="logo-icon">
                    <svg width="26" height="26" viewBox="0 0 24 24" fill="none">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <polyline points="9 22 9 12 15 12 15 22" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="logo-text">Horoazhon</div>
            </div>

            <h1>Activer mon compte</h1>

            {% if not valid %}
                <div class="error-message">
                    Ce lien d'activation est invalide ou a expire. Veuillez contacter votre agence pour obtenir un nouveau lien.
                </div>
                <a href="{{ path('login') }}" class="btn btn-secondary">Retour a la connexion</a>
            {% elseif activated %}
                <div class="success-message">
                    Votre compte a ete active avec succes! Vous pouvez maintenant vous connecter.
                </div>
                <a href="{{ path('login') }}" class="btn btn-primary">Se connecter</a>
            {% else %}
                <p>Choisissez votre mot de passe pour activer votre compte.</p>

                {% if error %}
                    <div class="error-message">{{ error }}</div>
                {% endif %}

                <form method="POST">
                    <input type="hidden" name="token" value="{{ token }}">
                    <div class="form-group">
                        <label for="password">Mot de passe</label>
                        <input type="password" id="password" name="password" placeholder="Minimum 6 caracteres" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label for="password_confirm">Confirmer le mot de passe</label>
                        <input type="password" id="password_confirm" name="password_confirm" placeholder="Confirmez votre mot de passe" required minlength="6">
                    </div>
                    <button type="submit" class="btn btn-primary">Activer mon compte</button>
                </form>
            {% endif %}
        </div>

        <p class="login-footer-text">&copy; {{ "now"|date("Y") }} Horoazhon. Tous droits reserves.</p>
    </div>
</div>
{% endblock %}
